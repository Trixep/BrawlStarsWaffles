<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Runs Selector</title>
    <style>
      :root {
        --bg: #f5f6fa;
        --card-bg: #ffffff;
        --border: #dcdde1;
        --accent: #4070f4;
        --text: #2f3640;
        --checkbox-color: #4cd137;
        --error-color: #e84118;
      }

      body {
        font-family: "Inter", Arial, sans-serif;
        background: var(--bg);
        color: var(--text);
        padding: 40px;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
      }

      /* Header */
      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        margin-bottom: 20px;
        position: relative;
      }

      /* Global Points Counter: starts at 50%, but adjusts if necessary */
      #globalPoints {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        font-size: 22px;
        font-weight: bold;
        white-space: nowrap;
        transition: all 0.2s ease;
      }

      #globalPoints.over {
        color: var(--error-color);
      }

      /* Runs & Add Button */
      #addRun {
        background: var(--accent);
        color: white;
        border: none;
        border-radius: 8px;
        padding: 10px 18px;
        font-size: 15px;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        transition: 0.2s;
        margin-bottom: 20px;
      }

      #addRun:hover {
        background: #2f57d9;
      }

      .run {
        display: flex;
        gap: 12px;
        background: var(--card-bg);
        padding: 15px;
        border-radius: 10px;
        border: 1px solid var(--border);
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
        margin-top: 14px;
        width: fit-content;
        align-items: center;
      }

      select {
        padding: 8px 10px;
        border-radius: 6px;
        border: 1px solid var(--border);
        background: #fff;
        font-size: 14px;
        cursor: pointer;
        transition: 0.15s;
      }

      select:focus {
        border-color: var(--accent);
        outline: none;
        box-shadow: 0 0 4px rgba(64, 112, 244, 0.4);
      }

      input[type="checkbox"] {
        width: 28px;
        height: 28px;
        cursor: pointer;
        accent-color: var(--checkbox-color);
      }

      .waffles {
        font-weight: bold;
        margin-left: 20px;
      }

      #infoSection {
        margin-top: 30px;
        width: 100%;
        max-width: 800px;
        padding: 15px;
        border: 1px solid var(--border);
        border-radius: 10px;
        background: var(--card-bg);
      }

      table {
        border-collapse: collapse;
        margin-bottom: 15px;
        width: 100%;
      }

      th {
        width: 150px;
      }

      th,
      td {
        border: 1px solid var(--border);
        padding: 10px 25px;
        text-align: center;
      }

      th {
        background: #f0f0f0;
      }

      p {
        margin: 5px 0;
      }

      /* Mobile Support */
      @media (max-width: 768px) {
        body {
          padding: 20px;
        }

        h1 {
          font-size: 22px;
        }

        #addRun {
          padding: 8px 14px;
          font-size: 13px;
        }

        .run {
          padding: 10px;
          gap: 8px;
          flex-wrap: wrap;
        }

        select {
          padding: 6px 8px;
          font-size: 12px;
        }

        input[type="checkbox"] {
          width: 22px;
          height: 22px;
        }

        #globalPoints {
          font-size: 18px;
          left: auto;
          right: 10px; /* shifts to avoid blocking on small screens */
          transform: none;
        }

        #infoSection {
          padding: 10px;
        }

        th,
        td {
          padding: 6px 12px;
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>Runs</h1>
      <div id="globalPoints">Total: 0<small>/95</small></div>
    </div>
    <button id="addRun">Add Run</button>

    <div id="runsContainer"></div>

    <div id="infoSection">
      <table>
        <tr>
          <th>Placement bonus (Epic win)</th>
          <td>1</td>
          <td>2</td>
          <td>3</td>
          <td>4</td>
          <td>5-8</td>
          <td>9-10</td>
        </tr>
        <tr>
          <td>Waffles</td>
          <td>5</td>
          <td>4</td>
          <td>3</td>
          <td>2</td>
          <td>1</td>
          <td>0</td>
        </tr>
      </table>
      <table style="margin-top: 20px">
        <tr>
          <th>Stage</th>
          <td>1</td>
          <td>2</td>
          <td>3</td>
          <td>4</td>
          <td>5</td>
        </tr>
        <tr>
          <td>Waffles</td>
          <td>10</td>
          <td>12</td>
          <td>14</td>
          <td>16</td>
          <td>18</td>
        </tr>
      </table>
      <p>
        To use the website effectively, aim to reach the limit without exceeding
        it (you can calculate this using the site). Then, start a new run and
        try to win all five stages to earn the maximum number of waffles.
      </p>
      <p>
        <strong>Important:</strong> Finishing in 5thâ€“8th place still awards a
        waffle, so you can use this strategically to gean 1-1 waffle to reach
        the limit without going over.
      </p>
    </div>

    <script>
      const container = document.getElementById("runsContainer");
      const addBtn = document.getElementById("addRun");
      const globalPointsCounter = document.getElementById("globalPoints");

      const stageBasePoints = [10, 12, 14, 16, 18];
      const valuePoints = [5, 4, 3, 2, 1, 1, 1, 1, 0, 0];

      function createDropdown() {
        const select = document.createElement("select");
        for (let i = 1; i <= 10; i++) {
          const option = document.createElement("option");
          option.value = i;
          option.textContent = i;
          select.appendChild(option);
        }
        return select;
      }

      function addRunRow() {
        const row = document.createElement("div");
        row.className = "run";

        const dropdowns = [];

        for (let i = 0; i < 5; i++) {
          const wrapper = document.createElement("div");
          wrapper.style.display = "flex";
          wrapper.style.flexDirection = "column";
          wrapper.style.alignItems = "center";
          wrapper.style.gap = "6px";

          const dd = createDropdown();
          if (i !== 0) dd.disabled = true;
          wrapper.appendChild(dd);

          const toggleOne = document.createElement("input");
          toggleOne.type = "checkbox";
          toggleOne.checked = !dd.disabled;
          toggleOne.onchange = () => {
            dd.disabled = !toggleOne.checked;
            updateAllWaffles();
          };
          wrapper.appendChild(toggleOne);

          dd.onchange = updateAllWaffles;
          dropdowns.push(dd);
          row.appendChild(wrapper);
        }

        const removeBtn = document.createElement("button");
        removeBtn.type = "button";
        removeBtn.textContent = "Remove";
        Object.assign(removeBtn.style, {
          background: "#e84118",
          color: "white",
          border: "none",
          borderRadius: "6px",
          padding: "8px 12px",
          cursor: "pointer",
        });
        removeBtn.onclick = () => {
          row.remove();
          updateAllWaffles();
        };
        row.appendChild(removeBtn);

        const wafflesCounter = document.createElement("div");
        wafflesCounter.className = "waffles";
        wafflesCounter.textContent = "Waffles: 0";
        row.appendChild(wafflesCounter);

        container.appendChild(row);
        updateAllWaffles();
      }

      function updateAllWaffles() {
        let grandTotal = 0;
        const runs = container.querySelectorAll(".run");
        runs.forEach((r) => {
          const wafflesDiv = r.querySelector(".waffles");
          const dropdowns = Array.from(r.querySelectorAll("select"));
          let runTotal = 0;
          dropdowns.forEach((dd, idx) => {
            if (!dd.disabled) {
              const placement = parseInt(dd.value);
              const base = placement <= 4 ? stageBasePoints[idx] : 0;
              runTotal += base + valuePoints[placement - 1];
            }
          });
          wafflesDiv.textContent = "Waffles: " + runTotal;
          grandTotal += runTotal;
        });
        globalPointsCounter.innerHTML =
          "Total: " + grandTotal + "<small>/95</small>";
        globalPointsCounter.classList.toggle("over", grandTotal > 95);
      }

      addBtn.addEventListener("click", addRunRow);
    </script>
  </body>
</html>
